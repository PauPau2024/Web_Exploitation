# **Access Control** 

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Access control is the application of constraints on who or what is authorized to perform actions or access resources. In the context of web applications, access control is dependent on authentication and session management</span>

- **<span style="font-size: 18px">Authentication</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> </span><span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">confirms that the user is who they say they are</span>
- **<span style="font-size: 18px">Session management</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> </span><span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">identifies which subsequent HTTP requests are being made by that same user</span>
- **<span style="font-size: 18px">Access control</span>**<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> </span><span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">determines whether the user is allowed to carry out the action that they are attempting to perform</span>

## **<span style="font-size: 19px">Vertical access controls</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">With vertical access controls, different types of users have access to different application functions. For example, an administrator might be able to modify or delete any user's account, while an ordinary user has no access to these actions. Vertical access controls can be more fine-grained implementations of security models designed to enforce business policies such as separation of duties and least privilege.</span>

## **Horizontal access controls**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">With horizontal access controls, different users have access to a subset of resources of the same type. For example, a banking application will allow a user to view transactions and make payments from their own accounts, but not the accounts of any other use</span>

## **Context-dependent access controls**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Context-dependent access controls prevent a user performing actions in the wrong order. For example, a retail website might prevent users from modifying the contents of their shopping cart after they have made payment</span>

## **Broken access controls :-**

### **<span style="font-size: 17px">Vertical privilege escalation</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If a user can gain access to functionality that they are not permitted to access then this is vertical privilege escalation. For example, if a non-administrative user can gain access to an admin page where they can delete user accounts, then this is vertical privilege escalation.</span>

#### **<span style="font-size: 15px">Unprotected functionality</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">At its most basic, vertical privilege escalation arises where an application does not enforce any protection for sensitive functionality</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">a website might host sensitive functionality at the following URL</span>

```vbscript-html
https://insecure-website.com/admin
https://insecure-website.com/robots.txt
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">In some cases, sensitive functionality is concealed by giving it a less predictable URL. This is an example of so-called "security by obscurity". However, hiding sensitive functionality does not provide effective access control because users might discover the obfuscated URL in a number of ways.</span>

```javascript
<script>
	var isAdmin = false;
	if (isAdmin) {
		...
		var adminPanelTag = document.createElement('a');
		adminPanelTag.setAttribute('https://insecure-website.com/administrator-panel-yb556');
		adminPanelTag.innerText = 'Admin panel';
		...
	}
</script>
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">This script adds a link to the user's UI if they are an admin user. However, the script containing the URL is visible to all users regardless of their role.</span>

#### **<span style="font-size: 15px">Parameter-based access control methods</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some applications determine the user's access rights or role at login, and then store this information in a user-controllable location</span>

- <span style="font-size: 17px">A hidden field.</span>
- <span style="font-size: 17px">A cookie.</span>
- <span style="font-size: 17px">A preset query string parameter.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">The application makes access control decisions based on the submitted value. For example:</span>

```vbscript-html
https://insecure-website.com/login/home.jsp?admin=true
https://insecure-website.com/login/home.jsp?role=1
```

#### **<span style="font-size: 15px">Broken access control resulting from platform misconfiguration</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some applications enforce access controls at the platform layer. they do this by restricting access to specific URLs and HTTP methods based on the user's role</span>

```vbscript-html
DENY: POST, /admin/deleteUser, managers
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">This rule denies access to the </span>`POST`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> method on the URL </span>`/admin/deleteUser`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">, for users in the managers group.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some application frameworks support various non-standard HTTP headers that can be used to override the URL in the original request, such as </span>`X-Original-URL`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> and </span>`X-Rewrite-URL`

```vbscript-html
POST / HTTP/1.1
X-Original-URL: /admin/deleteUser
...
```

I<span style="font-size: 17px">f an attacker can use the </span>`GET`<span style="font-size: 17px"> (or another) method to perform actions on a restricted URL, they can bypass the access control that is implemented at the platform layer.</span>

**<span style="font-size: 19px">Horizontal privilege escalation</span><span style="font-family: Arial, Courier, sans-serif; color: rgb(255, 255, 255); font-size: 14px">L</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Horizontal privilege escalation occurs if a user is able to gain access to resources belonging to another user, instead of their own resources of that type. For example, if an employee can access the records of other employees as well as their own, then this is horizontal privilege escalation.</span>

```vbscript-html
https://insecure-website.com/myaccount?id=123
```

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">If an attacker modifies the </span>`id`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> parameter value to that of another user, they might gain access to another user's account page, and the associated data and functions.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">instead of an incrementing number, an application might use globally unique identifiers (GUIDs) to identify users. This may prevent an attacker from guessing or predicting another user's identifier. However, the GUIDs belonging to other users might be disclosed elsewhere in the application where users are referenced, such as user messages or reviews.</span>

### **<span style="font-size: 19px">Access control vulnerabilities in multi-step processes</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">the administrative function to update user details might involve the following steps</span>

1. <span style="font-size: 17px">Load the form that contains details for a specific user.</span>
2. <span style="font-size: 17px">Submit the changes.</span>
3. <span style="font-size: 17px">Review the changes and confirm</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Imagine a website where access controls are correctly applied to the first and second steps, but not to the third step. The website assumes that a user will only reach step 3 if they have already completed the first steps, which are properly controlled. An attacker can gain unauthorized access to the function by skipping the first two steps and directly submitting the request for the third step with the required parameters.</span>

# IDORs 

<span style="font-size: 19px">Insecure Direct Object References are a SubCategory of acces control vulnerabilities. IDORs Occurs if an application uses user-supplied input to access objects directly and an attacker can modify the input to obtain unauthorized access.</span>

<span style="font-size: 21px">  </span>**<span style="font-size: 21px">Referer-based access control</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some websites base access controls on the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header submitted in the HTTP request. The </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header can be added to requests by browsers to indicate which page initiated a request.</span>

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">For example, an application robustly enforces access control over the main administrative page at </span>`/admin`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">, but for sub-pages such as </span>`/admin/deleteUser`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> only inspects the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header. If the </span>`Referer`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> header contains the main </span>`/admin`<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px"> URL, then the request is allowed.</span>

### **<span style="font-size: 19px">Location-based access control</span>**

<span style="font-family: Arial, Courier, sans-serif; color: rgb(92, 92, 91); font-size: 18px">Some websites enforce access controls based on the user's geographical location. This can apply, for example, to banking applications or media services where state legislation or business restrictions apply. These access controls can often be circumvented by the use of web proxies, VPNs, or manipulation of client-side geolocation mechanisms.</span>

## **How to prevent access control vulnerabilities**

- <span style="font-size: 17px">Never rely on obfuscation alone for access control.</span>
- <span style="font-size: 17px">Unless a resource is intended to be publicly accessible, deny access by default.</span>
- <span style="font-size: 17px">Wherever possible, use a single application-wide mechanism for enforcing access controls.</span>
- <span style="font-size: 17px">At the code level, make it mandatory for developers to declare the access that is allowed for each resource, and deny access by default.</span>
- <span style="font-size: 17px">Thoroughly audit and test access controls to ensure they work as designed.</span>